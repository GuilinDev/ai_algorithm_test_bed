# 项目概览：AI 系统测试平台

本文档旨在全面介绍 AI 系统测试平台，这是一个用于高级搜索和 AI 实验的、支持 MLOps 的复杂平台。

## 1. 项目摘要

AI 系统测试平台是一个多功能的平台，旨在模拟生产环境，探索和展示先进的 AI 功能。它集成了三大核心功能：**搜索与推荐系统**、**上下文工程（RAG）模块**和**图像搜索系统**。该项目采用微服务风格的架构，强调模块化、可扩展性和现代 MLOps 实践。

该系统使用 Python 开发，并采用了一系列现代化技术栈，包括用于用户界面的 Gradio、用于机器学习模型的 scikit-learn 和 TensorFlow，以及用于高级 AI 功能（如图像搜索）的 Transformers/PyTorch。

## 2. 核心功能

该平台分为三个主要功能模块：

### a. 搜索与推荐系统
- **智能索引**：基于 TF-IDF 的倒排索引，并使用 `jieba` 进行中文分词。
- **点击率（CTR）预测**：实现了逻辑回归和 Wide & Deep 两种模型，用于预测点击率，优化搜索结果排序。
- **实时排序**：系统能够根据用户行为和 A/B 测试动态调整排序策略。
- **知识图谱**：利用基于大语言模型（LLM）的命名实体识别（NER）技术，构建和使用知识图谱，以增强语义搜索能力。

### b. 上下文工程（RAG）
- **混合检索**：结合传统的倒排索引搜索和知识图谱查询，为语言模型提供全面的上下文。
- **LLM 集成**：与 Ollama 等本地大语言模型推理服务无缝集成。
- **提示词工程**：为多种任务设计了优化且透明的提示词模板。
- **多源上下文**：能够从非结构化文档、知识图谱和结构化数据中检索和整合上下文。

### c. 图像搜索系统
- **CLIP 驱动**：基于 OpenAI 的 CLIP 模型，提供顶尖的多模态理解能力。
- **多模态搜索**：支持**以文搜图**和**以图搜图**两种搜索方式。
- **语义理解**：使用 512 维的嵌入向量，根据语义相似性精确匹配图像。
- **可扩展性**：专为实时处理设计，能够处理大规模图像库。

## 3. 系统架构

该系统采用清晰的、面向服务的架构设计，实现了关注点分离，并提升了模块化程度。

- **Web 界面层**：基于 Gradio 的 Web 界面（`portal.py`）是用户的主要入口。
- **应用层**：该层包含三个核心模块的界面和业务逻辑：搜索、RAG 和图像搜索。
- **服务层**：一组后端服务管理核心逻辑：
    - `DataService`：管理 CTR 数据和用户交互日志。
    - `IndexService`：处理文本索引、搜索和检索。
    - `ModelService`：管理机器学习模型的生命周期（训练、加载、预测）。
    - `ImageService`：驱动所有与图像相关的功能，包括搜索和管理。
    - `ExperimentService`：管理 A/B 测试和实验。
- **基础设施层**：
    - `ServiceManager`：一个用于服务发现和编排的中央管理器。
    - **监控**：提供系统性能和健康状况的实时监控。
    - **存储**：管理数据、模型和索引的持久化。

## 4. 项目结构

仓库主要目录结构如下：

- `src/search_engine/`：包含所有服务和 UI 标签页的核心源代码。
- `models/`：存储训练好的模型文件、索引和图像嵌入。
- `data/`：包含训练数据、预加载的文档和知识图谱数据。
- `docs/`：包含每个核心功能的详细指南。
- `tools/`：用于数据生成、监控等的实用工具脚本集合。
- `tests/`：包含单元测试和集成测试。
- `examples/`：以编程方式使用系统功能的示例脚本。

## 5. 快速开始

请按照以下步骤运行项目：

1.  **克隆仓库**。
2.  **安装依赖**：`pip install -r requirements.txt`
3.  **运行启动脚本**：`./quick_start.sh` 或 `python start_system.py`

系统将在 `http://localhost:7861` 上可用。启动脚本会在启动主应用前处理依赖检查、端口清理和索引构建。

## 6. 关键组件与服务

- **`start_system.py`**：启动应用的主入口。它执行预检并协调启动过程。
- **`src/search_engine/portal.py`**：UI 的核心。它使用 Gradio 创建基于标签页的界面，并集成了所有后端服务。
- **`src/search_engine/service_manager.py`**：一个单例模式的管理器，负责初始化并提供对所有后端服务的访问，确保了清晰和解耦的架构。
- **服务模块 (`*_service.py`)**：每个服务（`DataService`, `IndexService`, `ModelService`, `ImageService`）都在其自己的模块中实现，封装了其特定的逻辑和数据。
- **UI 标签页 (`*_tab.py`)**：每个主要功能的 UI 都在其自己的模块中定义（例如 `index_tab.py`, `search_tab.py`），然后由 `portal.py` 组装起来。
